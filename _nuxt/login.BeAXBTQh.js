import{f as ce,g as pe,I as me,m as ve,h as fe,i as ge,j as ye,k as be,l as he,n as ke,q as we,r as _e,s as xe,v as $e,x as Ce,y as I,z as Ve,A as Pe,B as Se,C as Ie,D as Ae,E as Be,F as Ee,G as De,H as Te,J as Fe,K as ze,b as l,L as Le,V as Re,M as X,N as _,O as oe,P as Ue,Q as Ke,R as Oe,S as r,T as Ne,o as c,c as F,U as Ze,a as m,t as o,W as Me,w as n,X as f,d,Y as s,Z as U,$ as Y,a0 as ee,a1 as te,a2 as y,a3 as le,a4 as p,p as je,e as Ge,a5 as We}from"./entry.DQxhvQZe.js";import{V as K,a as O}from"./VTextField.D3GM2x5f.js";import{V as ae,a as qe,b as He,c as se,d as Je}from"./VDialog.D_uveyEj.js";import{_ as Qe}from"./_plugin-vue_export-helper.DlAUqK2U.js";import"./forwardRefs.DC-jezkJ.js";const Xe=window.setInterval,Ye=ce("v-alert-title"),et=["success","info","warning","error"],tt=pe({border:{type:[Boolean,String],validator:t=>typeof t=="boolean"||["top","end","bottom","start"].includes(t)},borderColor:String,closable:Boolean,closeIcon:{type:me,default:"$close"},closeLabel:{type:String,default:"$vuetify.close"},icon:{type:[Boolean,String,Function,Object],default:null},modelValue:{type:Boolean,default:!0},prominent:Boolean,title:String,text:String,type:{type:String,validator:t=>et.includes(t)},...ve(),...fe(),...ge(),...ye(),...be(),...he(),...ke(),...we(),..._e(),...xe({variant:"flat"})},"VAlert"),lt=$e()({name:"VAlert",props:tt(),emits:{"click:close":t=>!0,"update:modelValue":t=>!0},setup(t,N){let{emit:M,slots:i}=N;const v=Ce(t,"modelValue"),x=I(()=>{if(t.icon!==!1)return t.type?t.icon??`$${t.type}`:t.icon}),b=I(()=>({color:t.color??t.type,variant:t.variant})),{themeClasses:j}=Ve(t),{colorClasses:z,colorStyles:$,variantClasses:g}=Pe(b),{densityClasses:V}=Se(t),{dimensionStyles:A}=Ie(t),{elevationClasses:Z}=Ae(t),{locationStyles:P}=Be(t),{positionClasses:B}=Ee(t),{roundedClasses:G}=De(t),{textColorClasses:C,textColorStyles:W}=Te(Fe(t,"borderColor")),{t:h}=ze(),E=I(()=>({"aria-label":h(t.closeLabel),onClick(k){v.value=!1,M("click:close",k)}}));return()=>{const k=!!(i.prepend||x.value),L=!!(i.title||t.title),R=!!(i.close||t.closable);return v.value&&l(t.tag,{class:["v-alert",t.border&&{"v-alert--border":!!t.border,[`v-alert--border-${t.border===!0?"start":t.border}`]:!0},{"v-alert--prominent":t.prominent},j.value,z.value,V.value,Z.value,B.value,G.value,g.value,t.class],style:[$.value,A.value,P.value,t.style],role:"alert"},{default:()=>{var D,S;return[Le(!1,"v-alert"),t.border&&l("div",{key:"border",class:["v-alert__border",C.value],style:W.value},null),k&&l("div",{key:"prepend",class:"v-alert__prepend"},[i.prepend?l(X,{key:"prepend-defaults",disabled:!x.value,defaults:{VIcon:{density:t.density,icon:x.value,size:t.prominent?44:28}}},i.prepend):l(Re,{key:"prepend-icon",density:t.density,icon:x.value,size:t.prominent?44:28},null)]),l("div",{class:"v-alert__content"},[L&&l(Ye,{key:"title"},{default:()=>{var w;return[((w=i.title)==null?void 0:w.call(i))??t.title]}}),((D=i.text)==null?void 0:D.call(i))??t.text,(S=i.default)==null?void 0:S.call(i)]),i.append&&l("div",{key:"append",class:"v-alert__append"},[i.append()]),R&&l("div",{key:"close",class:"v-alert__close"},[i.close?l(X,{key:"close-defaults",defaults:{VBtn:{icon:t.closeIcon,size:"x-small",variant:"text"}}},{default:()=>{var w;return[(w=i.close)==null?void 0:w.call(i,{props:E.value})]}}):l(_,oe({key:"close-btn",icon:t.closeIcon,size:"x-small",variant:"text"},E.value),null)])]}})}}}),at=t=>(je("data-v-4d65e333"),t=t(),Ge(),t),st={class:"inner-wrapper mt-16"},ot={class:"flex-item text-h4 font-weight-bold mb-4"},nt={class:"text-subtitle-2"},it={class:"font-weight-bold"},rt=at(()=>m("br",null,null,-1)),ut={key:0,class:"text-red-darken-3 mt-1 text-subtitle-2 text-disabled"},dt={class:"font-weight-bold text-high-emphasis"},ct={class:"px-5"},pt={class:"py-auto text-subtitle-2"},mt={class:"px-5"},vt={class:"py-auto text-subtitle-2"},ft={class:"px-5"},gt={class:"py-auto text-subtitle-2"},yt={key:0,class:"text-center pt-1 text-subtitle-2 text-red-darken-3"},bt={key:0,class:"text-center pt-0 text-subtitle-2 text-blue-lighten-4 mb-2"},ht={class:""},kt={key:1,class:"text-center pt-0 text-subtitle-2 text-red-darken-3"},wt={class:"text-center my-3"},_t={key:0,class:"text-red-darken-3 mt-1 text-subtitle-2 text-disabled"},xt={class:"font-weight-bold text-high-emphasis"},$t={class:"grey--text text--darken-2 w-75 text-center mt-6 text-caption"},Ct={class:""},Vt=Ue({__name:"login",setup(t){const N=Ke(),M=Oe(),i=We(),v=r(""),x=r(""),b=r(!1),j=r("Continue with E-mail"),z=r(!0),$=r(!1),g=r(!1),V=r(120),A=r(!1),Z=r(""),P=r(""),B=r(!0),G=r(!1),C=r(!1),W=r(!1),h=r(""),E=r(!0),k=r(!1),L=r(!1),R=r(!1),D=r(""),S=r("");r("");const w=r(""),q=r("");function H(e){return/^[A-Za-z0-9._-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,}$/.test(e)}const J=()=>{if(b.value=!0,v.value===""||!H(v.value)){b.value=!1,z.value=!1;return}O({method:"GET",url:`${i.public.API_BASE_URL}members/emailcheck/?email=${v.value}`}).then(e=>{if(e.data.status_code==="400"){C.value=!0,b.value=!1;return}else if(e.status===200){const a=new FormData;a.append("email",v.value),O({method:"POST",data:a,url:`${i.public.API_BASE_URL}members/send-confirmation/`}).then(u=>{console.log(u.data),b.value=!1,j.value="Create new account",$.value=!0,Z.value=u.data.key,localStorage.setItem("email",v.value)}).catch(u=>{console.log("err; ",u),b.value=!1})}}).catch(e=>{console.log("err; ",e)})},Q=()=>{const e=new FormData;e.append("email",v.value),e.append("password",x.value),O({method:"POST",data:e,url:`${i.public.API_BASE_URL}members/api/token/`}).then(a=>{M.setSession(a.data),b.value=!1,N.route_to("/kr/class/classInfo")}).catch(a=>{console.log("err; ",a),A.value=!0,b.value=!1})},ne=e=>{if(P.value===""){B.value=!1;return}else if(P.value===Z.value)N.route_to("/kr/account/register");else{B.value=!1;return}},ie=()=>{if(k.value=!0,g.value=!0,h.value===""||!H(h.value)){k.value=!1,E.value=!1,g.value=!1;return}O({method:"GET",url:`${i.public.API_BASE_URL}user/emailcheck/?email=${h.value}`}).then(e=>{if(console.log("res: ",e),e.status===226){const a=new FormData;a.append("email",h.value),O({method:"POST",url:`${i.public.API_BASE_URL}user/custom-password-reset/`,data:a}).then(u=>{k.value=!1,R.value=!0,D.value=u.data.key}).catch(u=>{console.log("err; ",u),k.value=!1});return}else if(e.status===200){k.value=!1,L.value=!0,g.value=!1;return}}).catch(e=>{console.log("err; ",e)})},re=I(()=>D.value!==""&&S.value===D.value),ue=I(()=>w.value===q.value),de=I(()=>w.value!==""||q.value!==""?/^(?=.*[a-zA-Z])(?=.*[0-9])(?=.*[!@#$%^&*()_+|~=\-{}\[\]:\";'<>?,.\/]).{8,16}$/.test(w.value):!0);return I(()=>w.value!==""&&q.value!==""&&ue.value&&de.value),Ne(()=>g.value,e=>{if(e){const a=Xe(()=>{V.value-=1,V.value===0&&(clearInterval(a),g.value=!1,V.value=120)},1e3)}}),(e,a)=>(c(),F("div",st,[l(Ze,{src:"/img/logo.png",class:"app-logo-img flex-item"}),m("p",ot,o(e.$t("page.login.title")),1),l(Me,{style:{width:"20rem"},class:"my-6"}),l(le,{style:{width:"320px"}},{default:n(()=>[l(f,{cols:"12",class:"text-subtitle-2 pl-1 pb-0"},{default:n(()=>[d(o(e.$t("page.login.email")),1)]),_:1}),l(K,{density:"compact",placeholder:e.$t("page.login.placeholder"),"hide-details":"true",modelValue:s(v),"onUpdate:modelValue":a[0]||(a[0]=u=>U(v)?v.value=u:null),class:"mt-1",clearable:!0,"clear-icon":"mdi-close-circle-outline",onInput:a[1]||(a[1]=u=>z.value=!0),variant:"solo",type:"email",onKeyup:Y(J,["enter"]),autofocus:!0,disabled:s($)},null,8,["placeholder","modelValue","disabled"]),ee(l(f,{cols:"12",class:"text-subtitle-2 text-green-darken-3 text-center py-0"},{default:n(()=>[d(o(e.$t("page.login.already")),1)]),_:1},512),[[te,s(C)]]),s($)?(c(),y(f,{key:0,cols:"12"},{default:n(()=>[l(lt,{type:"success",dense:"",dismissible:"",variant:"outlined",class:"mb-0"},{default:n(()=>[m("span",nt,[d(o(e.$t("page.login.emailSent1"))+" ",1),m("span",it,o(s(v)),1),d(". "),rt,d(" "+o(e.$t("page.login.emailSent2")),1)]),l(le,{justify:"center","align-content":"center",class:"mt-1"},{default:n(()=>[l(ae),l(f,{cols:"8"},{default:n(()=>[l(_,{size:"x-small",color:"#1B5E20",width:100,disabled:s(g),onClick:a[2]||(a[2]=u=>{g.value=!0})},{default:n(()=>[d(o(e.$t("page.login.resend")),1)]),_:1},8,["disabled"])]),_:1}),l(ae)]),_:1}),s(g)?(c(),F("p",ut,[d(o(e.$t("page.login.resendMsg"))+" ",1),m("span",dt,o(s(V)),1)])):p("",!0)]),_:1})]),_:1})):p("",!0),s($)?(c(),y(f,{key:1,cols:"12",class:"text-subtitle-2 pl-1 py-0"},{default:n(()=>[d(o(e.$t("page.login.confirmationCode")),1)]),_:1})):p("",!0),s($)?(c(),y(K,{key:2,density:"compact",placeholder:e.$t("page.login.confirmationCodePlaceholder"),"hide-details":"true",modelValue:s(P),"onUpdate:modelValue":a[3]||(a[3]=u=>U(P)?P.value=u:null),clearable:!0,"clear-icon":"mdi-close-circle-outline",variant:"solo",class:"mt-1",onInput:a[4]||(a[4]=u=>B.value=!0)},null,8,["placeholder","modelValue"])):p("",!0),s($)?p("",!0):(c(),y(f,{key:3,cols:"12",class:"pb-0"},{default:n(()=>[s(C)?p("",!0):(c(),y(_,{key:0,class:"mt-1 btn-flex mb-2",color:"#40557C",loading:s(b),onClick:J},{default:n(()=>[m("span",ct,[m("span",pt,o(e.$t("page.login.loginButton")),1)])]),_:1},8,["loading"]))]),_:1})),s(C)?(c(),y(f,{key:4,cols:"12",class:"text-subtitle-2 pl-1 py-0"},{default:n(()=>[d(o(e.$t("page.login.pwd")),1)]),_:1})):p("",!0),ee(l(K,{density:"compact",placeholder:e.$t("page.login.pwdPlaceholder"),"hide-details":"true",modelValue:s(x),"onUpdate:modelValue":a[5]||(a[5]=u=>U(x)?x.value=u:null),type:"password",onKeyup:Y(Q,["enter"]),id:"pwd",autofocus:s(C),onInput:a[6]||(a[6]=u=>A.value=!1),onFocus:a[7]||(a[7]=u=>A.value=!1),clearable:!0,"clear-icon":"mdi-close-circle-outline",variant:"solo",class:"mt-1"},null,8,["placeholder","modelValue","autofocus"]),[[te,s(C)]]),s(A)?(c(),y(f,{key:5,cols:"12",class:"text-center pt-1 text-subtitle-2 text-red-darken-3"},{default:n(()=>[d(o(e.$t("page.login.wrongPwd")),1)]),_:1})):p("",!0),s(C)?(c(),y(f,{key:6},{default:n(()=>[l(_,{class:"mt-1 btn-flex mb-2",color:"#40557C",loading:s(b),onClick:Q},{default:n(()=>[m("span",mt,[m("span",vt,o(e.$t("page.login.loginButton")),1)])]),_:1},8,["loading"])]),_:1})):p("",!0),s($)?(c(),y(f,{key:7,cols:"12",class:"pb-0"},{default:n(()=>[l(_,{class:"mt-1 btn-flex mb-2",color:"#40557C",loading:s(G),onClick:ne},{default:n(()=>[m("span",ft,[m("span",gt,o(e.$t("page.login.newAccount")),1)])]),_:1},8,["loading"])]),_:1})):p("",!0),s(z)?p("",!0):(c(),y(f,{key:8,cols:"12",class:"text-center pt-0 text-subtitle-2 text-red-darken-3"},{default:n(()=>[d(" Please enter a valid email address. ")]),_:1})),s(B)?p("",!0):(c(),y(f,{key:9,cols:"12",class:"text-center pt-0 text-subtitle-2 text-red-darken-3"},{default:n(()=>[d(" Please enter a valid code. ")]),_:1})),l(f,{cols:"12",class:"text-center pt-0"},{default:n(()=>[l(qe,{width:"500"},{activator:n(({props:u})=>[l(_,oe({variant:"plain"},u,{onClick:a[8]||(a[8]=T=>W.value=!0),ripple:!1,class:"text-subtitle-2 grey--text text--darken-2"}),{default:n(()=>[d(o(e.$t("page.login.pwdFind")),1)]),_:2},1040)]),default:n(({isActive:u})=>[s(re)?p("",!0):(c(),y(Je,{key:0,elevation:"14",density:"compact"},{default:n(()=>[l(He,{class:"text-body-2"},{default:n(()=>[d(o(e.$t("page.login.pwdFind")),1)]),_:1}),l(se,null,{default:n(()=>[l(K,{density:"compact",placeholder:e.$t("page.login.placeholder"),"hide-details":"true",class:"mt-1",modelValue:s(h),"onUpdate:modelValue":a[9]||(a[9]=T=>U(h)?h.value=T:null),clearable:!0,"clear-icon":"mdi-close-circle-outline",onInput:a[10]||(a[10]=T=>{E.value=!0,L.value=!1}),variant:"solo",type:"email",disabled:s(R)},null,8,["placeholder","modelValue","disabled"]),s(L)?(c(),F("p",yt,"Email dose not exist.")):p("",!0)]),_:1}),s(R)?(c(),F("div",bt,[m("span",ht,o(e.$t("page.login.pwdFind")),1),d(" "+o(e.$t("page.login.emailSent1"))+" "+o(s(h))+" ",1),m("p",null,o(e.$t("page.login.emailSent2")),1),l(se,null,{default:n(()=>[l(K,{density:"compact",placeholder:e.$t("page.login.confirmationCodePlaceholder"),"hide-details":"true",modelValue:s(S),"onUpdate:modelValue":a[11]||(a[11]=T=>U(S)?S.value=T:null),clearable:!0,"clear-icon":"mdi-close-circle-outline",variant:"solo",class:"mt-1"},null,8,["placeholder","modelValue"])]),_:1})])):p("",!0),s(E)?p("",!0):(c(),F("p",kt," Please enter a valid email address. ")),m("div",wt,[l(_,{color:"#DB5D5C",size:"small",class:"mx-1",onClick:T=>u.value=!1,variant:"elevated"},{default:n(()=>[d(o(e.$t("common.cancel")),1)]),_:2},1032,["onClick"]),l(_,{color:"#40557C",size:"small",class:"mx-1",variant:"elevated",onClick:ie,disabled:s(g),loading:s(k)},{default:n(()=>[d(o(e.$t("page.login.pwdCodeBtn")),1)]),_:1},8,["disabled","loading"]),s(g)?(c(),F("p",_t,[d(o(e.$t("page.login.resendMsg"))+" ",1),m("span",xt,o(s(V)),1)])):p("",!0)])]),_:2},1024))]),_:1})]),_:1})]),_:1}),m("div",$t,[d(o(e.$t("page.login.policy.text"))+" ",1),l(_,{variant:"plain",href:"#",ripple:!1,size:"x-small",class:"text-subtitle-2 px-0"},{default:n(()=>[d(o(e.$t("page.login.policy.termOfService")),1)]),_:1}),d(" "+o(e.$t("page.login.policy.and"))+" ",1),l(_,{href:"#",variant:"plain",ripple:!1,size:"x-small",class:"text-subtitle-2 px-0"},{default:n(()=>[d(o(e.$t("page.login.policy.privacyPolicy")),1)]),_:1}),d(" "+o(e.$t("page.login.policy.of"))+" ",1),m("span",Ct,o(e.$t("page.login.policy.text2")),1)])]))}}),Et=Qe(Vt,[["__scopeId","data-v-4d65e333"]]);export{Et as default};
